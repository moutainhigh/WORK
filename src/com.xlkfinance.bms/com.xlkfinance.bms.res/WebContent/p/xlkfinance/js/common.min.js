$(function(){$(".DateTime").focus(function(){new WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',skin:'whyGreen'})});$(".Date").click(function(){new WdatePicker({dateFmt:'yyyy-MM-dd',skin:'whyGreen'})});$(".easyui-numberbox").each(function(i){var v=$(this).numberbox('getValue');if(v=='0'||v=='0.0'||v=='0.00'||v=='0.0000'){$(this).numberbox('setValue','')}});checkValueScript()});function loadSel(selId,selVal){$("#"+selId).combobox('setValue',selVal)}function setCombobox(inputId,lookupType,selVal){$('#'+inputId).combobox({url:'${basePath }sysLookupController/getSysLookupValByLookType.action?lookupType='+lookupType,valueField:'pid',textField:'lookupDesc',value:'-1',onLoadSuccess:function(rec){if(selVal!=''&&selVal!='0'&&selVal!='-1'){loadSel(inputId,selVal)}}})}function setSalesList(inputId,roleCode,selVal){$('#'+inputId).combobox({url:'${basePath }systemRoleController/findUsersByRoleCode.action?roleCode='+roleCode,valueField:'pid',textField:'realName',value:'-1',onLoadSuccess:function(rec){if(selVal!=''&&selVal!='0'&&selVal!='-1'){loadSel(inputId,selVal)}}})}function setCombobox2(inputId,lookupType,selVal){$('#'+inputId).combobox({url:'${basePath }sysLookupController/getSysLookupValByLookTypeThree.action?lookupType='+lookupType,valueField:'pid',textField:'lookupDesc',value:'0',onLoadSuccess:function(rec){if(selVal!=''&&selVal!='0'&&selVal!='-1'){loadSel(inputId,selVal)}}})}function center_addTab(opts){var t=$('#layout_center_tabs');if(t.tabs('exists',opts.title)){t.tabs('select',opts.title)}else{t.tabs('add',opts)}}function addTab(url,title){center_addTab({title:title,closable:true,content:'<iframe src="'+url+'" frameborder="0" style="border:0;width:100%;height:99%;"></iframe>'})}function compareDate(beginDt,endDt){var starTime=$('#'+beginDt).datebox('getValue');var endTime=$('#'+endDt).datebox('getValue');if(starTime>endTime){$('#'+endDt).datebox('setValue','');$.messager.alert("提示",'请选择正确的日期范围');return false}return true}function stripValueScript(s){var pattern=new RegExp("[%`~$^&*=|{}':;'\\[\\]<>?~#￥……&*——|{}【】‘；：”“']");var rs="";for(var i=0;i<s.length;i++){rs=rs+s.substr(i,1).replace(pattern,'')}return rs}$.fn.textbox.defaults.formatter=function(v){return stripValueScript(v)};function checkValueScript(){$('body').delegate('textarea,input','blur',function(){var v=stripValueScript($(this).val());$(this).val(v)})}function dataGridClearSelections(id){$(id).datagrid('clearSelections')}var sy=$.extend({},sy);$.fn.panel.defaults.onBeforeDestroy=function(){var frame=$('iframe',this);try{if(frame.length>0){frame[0].contentWindow.document.write('');frame[0].contentWindow.close();frame.remove();if($.browser.msie){CollectGarbage()}}else{$(this).find('.combo-f').each(function(){var panel=$(this).data().combo.panel;panel.panel('destroy')})}}catch(e){}};$.fn.panel.defaults.loadingMessage='数据正在努力为您加载，请稍候....';$.fn.datagrid.defaults.loadMsg='数据正在努力为您加载，请稍候....';var easyuiErrorFunction=function(XMLHttpRequest){$.messager.alert('提示框','后台错误请与管理员联系!','warning',function(){})};$.fn.datagrid.defaults.onLoadError=easyuiErrorFunction;$.fn.treegrid.defaults.onLoadError=easyuiErrorFunction;$.fn.combogrid.defaults.onLoadError=easyuiErrorFunction;$.fn.combobox.defaults.onLoadError=easyuiErrorFunction;$.fn.form.defaults.onLoadError=easyuiErrorFunction;$.extend($.fn.datagrid.defaults.editors,{datetimebox:{init:function(container,options){var editor=$('<input/>').appendTo(container);editor.datetimebox(options);return editor},destroy:function(target){$(target).datetimebox('destroy')},getValue:function(target){return $(target).parent().find('input.combo-value').val()},setValue:function(target,value){$(target).datetimebox("setValue",value)},resize:function(target,width){$(target).datetimebox('resize',width)}}});$.extend($.fn.datagrid.defaults.editors,{combocheckboxtree:{init:function(container,options){var editor=$('<input/>').appendTo(container);options.multiple=true;editor.combotree(options);return editor},destroy:function(target){$(target).combotree('destroy')},getValue:function(target){return $(target).combotree('getValues').join(',')},setValue:function(target,value){$(target).combotree('setValues',sy.getList(value))},resize:function(target,width){$(target).combotree('resize',width)}}});sy.bp=function(){var curWwwPath=window.document.location.href;var pathName=window.document.location.pathname;var pos=curWwwPath.indexOf(pathName);var localhostPaht=curWwwPath.substring(0,pos);var projectName=pathName.substring(0,pathName.substr(1).indexOf('/')+1);return(localhostPaht+projectName)};sy.bpName=function(){var curWwwPath=window.document.location.href;var pathName=window.document.location.pathname;var pos=curWwwPath.indexOf(pathName);var localhostPaht=curWwwPath.substring(0,pos);var projectName=pathName.substring(0,pathName.substr(1).indexOf('/')+1);return(projectName)};sy.fs=function(str){for(var i=0;i<arguments.length-1;i++){str=str.replace("{"+i+"}",arguments[i+1])}return str};sy.ns=function(){var o={},d;for(var i=0;i<arguments.length;i++){d=arguments[i].split(".");o=window[d[0]]=window[d[0]]||{};for(var k=0;k<d.slice(1).length;k++){o=o[d[k+1]]=o[d[k+1]]||{}}}return o};sy.random4=function(){return(((1+Math.random())*0x10000)|0).toString(16).substring(1)};sy.UUID=function(){return(sy.random4()+sy.random4()+"-"+sy.random4()+"-"+sy.random4()+"-"+sy.random4()+"-"+sy.random4()+sy.random4()+sy.random4())};sy.getUrlParam=function(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null)return unescape(r[2]);return null};sy.getList=function(value){if(value){var values=[];var t=value.split(',');for(var i=0;i<t.length;i++){values.push(''+t[i])}return values}else{return[]}};sy.png=function(){var imgArr=document.getElementsByTagName("IMG");for(var i=0;i<imgArr.length;i++){if(imgArr[i].src.toLowerCase().lastIndexOf(".png")!=-1){imgArr[i].style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+imgArr[i].src+"', sizingMethod='auto')";imgArr[i].src="images/blank.gif"}if(imgArr[i].currentStyle.backgroundImage.lastIndexOf(".png")!=-1){var img=imgArr[i].currentStyle.backgroundImage.substring(5,imgArr[i].currentStyle.backgroundImage.length-2);imgArr[i].style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+img+"', sizingMethod='crop')";imgArr[i].style.backgroundImage="url('images/blank.gif')"}}};sy.bgPng=function(bgElements){for(var i=0;i<bgElements.length;i++){if(bgElements[i].currentStyle.backgroundImage.lastIndexOf(".png")!=-1){var img=bgElements[i].currentStyle.backgroundImage.substring(5,bgElements[i].currentStyle.backgroundImage.length-2);bgElements[i].style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+img+"', sizingMethod='crop')";bgElements[i].style.backgroundImage="url('images/blank.gif')"}}};sy.isLessThanIe8=function(){return($.browser.msie&&$.browser.version<8)};$.ajaxSetup({type:'POST',error:function(XMLHttpRequest,textStatus,errorThrown){$.messager.progress('close');$.messager.alert('错误',XMLHttpRequest.responseText.split('<script')[0])}});var easyuiPanelOnMove=function(left,top){if(left<0){$(this).window('move',{left:1})}if(top<0){$(this).window('move',{top:1})}};$.fn.panel.defaults.onMove=easyuiPanelOnMove;$.fn.window.defaults.onMove=easyuiPanelOnMove;$.fn.dialog.defaults.onMove=easyuiPanelOnMove;function getRandomByTimeStamp(){var timestamp=new Date().getTime();return timestamp}function formatAccountState(val,row){if(val=='enabled'){return'<font color=green>启用</font>'}if(val=='disabled'){return'<font color=red>禁用</font>'}}function formatItem(row){var s='<span style="font-weight:bold">'+row.text+'</span><br/>'+'<span style="color:#888">'+row.desc+'</span>';return s}function formatCarUserCheck(val,row){if(val=='0'){return'<font color=gray>未提交审核</font>'}else if(val=='1'){return'<font color=blue>已提交审核</font>'}else if(val=='2'){return'<font color=purple>开始审核</font>'}else if(val=='3'){return'<font color=red>未通过</font>'}else if(val=='4'){return'<font color=green>车主(已通过)</font>'}}function formatTeantUserCheck(val,row){if(val=='0'){return'<font color=gray>未提交审核</font>'}else if(val=='1'){return'<font color=blue>已提交审核</font>'}else if(val=='2'){return'<font color=purple>开始审核</font>'}else if(val=='3'){return'<font color=red>未通过</font>'}else if(val=='4'){return'<font color=green>租客(已通过)</font>'}}function formatIMG(val,row){if(row.isStop=="1"){return'<font color="green">已上架</font>'}else if(row.isStop=="0"){return'<font color="red">已下架</font>'}else{return'<font color="bulle">未处理</font>'}}function formatSex(val,row){if(val=='0'){return'<font>男</font>'}if(val=='1'){return'<font>女</font>'}}function formatCar(val,row){if(val=='0'){return'<font color="gray">未提交审核</font>'}else if(val=='1'){return'<font color="blue">已提交车审核</font>'}else if(val=='2'){return'<font color="purple">开始审核</font>'}else if(val=='3'){return'<font color="green">审核通过</font>'}else if(val=='4'){return'<font color="red">审核未通过</font>'}}function formatNotRentTime(val,row){if(val.length==0){return''}else{num=val.split(",");var str='';for(var i=0;i<num.length;i++){str=str+num[i]+" "}return'<font color="red">'+str+'</font>'}}function formatTBUser(val,row){if(val==1){return'<font color="green">已注册成功用户</font>'}else{return'<font color="red">未验证用户</font>'}}function formatCarUser(val,row){return''+row.commentUser.userName+''}function formatCarName(val,row){return''+row.tCar.carName+''}function formatPlateNum(val,row){return''+row.tCar.plateNum+''}function formatPhone(val,row){return""+row.commentUser.phone+""}function formatterCommentState(val,row){if(val=='0'){return'<font color="green">通过</font>'}else{return'<font color="red">未通过</font>'}}function formatterOrderState(val,row){if(val=='-2'){return'<font color="violet">续租车主未确认</font>'}else if(val=='-1'){return'<font color="violet">续租确认未付款</font>'}else if(val=='0'){return'<font color="green">已下单(未付款等待车主确认)</font>'}else if(val=='1'){return'<font color="violet">车主确认(未付款)</font>'}else if(val=='2'){return'<font color="purple">已付款(未支付押金)</font>'}else if(val=='3'){return'<font color="purple">已支付押金(取车中)</font>'}else if(val=='4'){return'<font color="blue">已取车</font>'}else if(val=='5'){return'<font color="brown">租客确认已还车</font>'}else if(val=='6'){return'<font color="orange">车主确认已还车(已完成)</font>'}else if(val=='7'){return'<font color="gray">过期</font>'}else if(val=='8'){if(row.cancelPerson=='0'){return'<font color="red">取消(车主取消)</font>'}else if(row.cancelPerson=='1'){return'<font color="red">取消(租客取消)</font>'}else{return'<font color="red">取消</font>'}}else if(val=='9')return'<font color="yellowgreen">已结算</font>'}function formatterMoneyState(val,row){if(val=='0'){return'<font color="blue">已完成</font>'}else if(val=='1'){return'<font color="red">未处理</font>'}else if(val=='2'){return'<font color="brown">已撤销</font>'}else if(val=='3'){return'<font color="purple">未收取</font>'}}function formatterOrderCarUser(val,row){return''+row.carUser.userName+''}function formatterOrderCar(val,row){return''+row.car.carName+''}function formatterOrderRentUser(val,row){return''+row.rentCarUser.userName+''}function formatterUserBillState(val,row){if(val=='0'){return'<font color="red">冻结中</font>'}else if(val=='1'){return'<font color="green">已完成</font>'}else if(val=='2'){return'<font color="blue">取消入账</font>'}}function accidentState(val,row){if(val=='0'){return'<font color="red">否</font>'}else if(val=='1'){return'<font color="green">是</font>'}else{return'<font color="gray">未处理</font>'}}function formatffollow(val,row){if(val=='0'){return'<font color="violet">已提交故障信息</font>'}else if(val=='1'){return'<font color="green">跟进中</font>'}else if(val=='2'){return'<font color="purple">已跟进</font>'}}function formatAccidentfollow(val,row){if(val=='0'){return'<font color="violet">事故信息已录入</font>'}else if(val=='1'){return'<font color="purple">已通知租客交纳资料</font>'}else if(val=='2'){return'<font color="blue">理赔资料已收</font>'}else if(val=='3'){return'<font color="gray">已交案</font>'}else if(val=='4'){return'<font color="red">已赔付</font>'}else if(val=='5'){return'<font color="green">已结案</font>'}}function formatTransMission(val,row){if(val=='1'){return'<font color="violet">不限</font>'}else if(val=='2'){return'<font color="green">自动挡</font>'}else if(val=='3'){return'<font color="purple">手动挡</font>'}}function formatCarEmission(val,row){if(val=='1'){return'<font color="violet">不限</font>'}else if(val=='2'){return'<font color="green">1.6L及以下</font>'}else if(val=='3'){return'<font color="purple">1.6L~2.0L</font>'}else if(val=='4'){return'<font color="orange">2.0L~2.5L</font>'}else if(val=='5'){return'<font color="blue">2.5L及以上</font>'}}function carState(val,row){if(val=='0'){return'<font color="green">可租</font>'}else if(val=='1'){return'<font color="violet">在租</font>'}else if(val=='2'){return'<font color="orange">维修</font>'}else if(val=='3'){return'<font color="red">停用</font>'}}function formatterApplyState(val,row){if(val=='0'){return'<font color="orange">审核中</font>'}else if(val=='1'){return'<font color="green">提现完成</font>'}else if(val=='2'){return'<font color="red">审核失败</font>'}}function formatRegisterChannel(val,row){if(val=='0'){return'<font color="violet">微信</font>'}else if(val=='1'){return'<font color="green">官网</font>'}else if(val=='2'){return'<font color="purple">第三方合作商</font>'}else if(val=='3'){return'<font color="orange">APP</font>'}else if(val=='4'){return'<font color="blue">线下</font>'}}function formatReletType(val,row){if(val=='0'){return'<font color="violet">车主未确认</font>'}else if(val=='1'){return'<font color="purple">确认未付款</font>'}else if(val=='2'){return'<font color="blue">已付款</font>'}else if(val=='3'){return'<font color="gray">支付过期</font>'}else if(val=='4'){return'<font color="red">车主拒绝续约</font>'}else if(val=='5'){return'<font color="green">已结算</font>'}}function formatterChuliState(val,row){if(val=='0'){return'<font color="red">未处理</font>'}else if(val=='3'){return'<font color="green">已处理</font>'}}function formattercZrZ(val,row){if(val=='0'){return'<font color="red">未审核</font>'}else if(val=='1'){return'<font color="purple">不同意</font>'}else if(val=='2'){return'<font color="orange">同意</font>'}}function formatterIDState(val,row){if(val=='1'){return'<font color="violet">身份证</font>'}else if(val=='2'){return'<font color="purple">护照</font>'}else if(val=='3'){return'<font color="blue">军官证</font>'}}function formatterYHQ(val,row){if(val=='0'){return'<font color="red">未激活</font>'}else if(val=='1'){return'<font color="blue">已激活/未使用</font>'}else if(val=='2'){return'<font color="purple">使用中</font>'}else if(val=='3'){return'<font color="orange">已使用</font>'}else if(val=='4'){return'<font>已过期</font>'}}function formatterUserNum(val,row){if(val=='1'){return'<font>2人</font>'}else if(val=='2'){return'<font>4人</font>'}else if(val=='3'){return'<font>5人</font>'}else if(val=='4'){return'<font>7人及以上</font>'}}function formatterMileage(val,row){if(val=='1'){return'<font>不限</font>'}else if(val=='2'){return'<font>低于2万公里</font>'}else if(val=='3'){return'<font>2-4万公里</font>'}else if(val=='4'){return'<font>4-6万公里</font>'}else if(val=='5'){return'<font>6-9万公里</font>'}else if(val=='6'){return'<font>9-12万公里</font>'}else if(val=='7'){return'<font>12-15万公里</font>'}else if(val=='8'){return'<font>15-20万公里</font>'}else if(val=='9'){return'<font>超过20万公里</font>'}}function ajaxSearch(datagrid,fromId){$(fromId).form('submit',{success:function(data){$(datagrid).datagrid('loadData',eval("("+data+")"))}})}function ajaxSearchPage(datagrid,formId){$(datagrid).datagrid('load',$.serializeObject($(formId)))}$.serializeObject=function(formId){var o={};$.each(formId.serializeArray(),function(index){if(o[this['name']]){o[this['name']]=o[this['name']]+","+this['value']}else{o[this['name']]=this['value']}});return o};function formatStatus(val,row){if(val==0){return'已删除'}else if(val==1){return'正常'}else if(val==-1){return'新用户'}else{return val}}function formatLookupStatus(val,row){if(val==0){return'已删除'}else if(val==1){return'正常'}else{return val}}function openFileUpload(imgurl,topwid){$('<div id="winUploadFile"/>').dialog({href:'uploadFile.action?imgurl='+imgurl,width:500,height:180,top:topwid,modal:true,title:'附件上传',buttons:[{text:'上传',iconCls:'icon-save',handler:function(){window.save()}},{text:'取消 ',iconCls:'icon-cancel',handler:function(){$("#winUploadFile").dialog('close')}}],onClose:function(){$(this).dialog('destroy')},onLoad:function(){}})}function putAway(divId){$(divId).hide();$(divId).parent().parent().parent().find('.upbtn').addClass('none');$(divId).parent().parent().parent().find('.openbtn').removeClass('none')}function openUp(divId){$(divId).show();$(divId).parent().parent().parent().find('.openbtn').addClass('none');$(divId).parent().parent().parent().find('.upbtn').removeClass('none')}function formatMoney(value,row,index){if(value){return accounting.formatMoney(value,"",2,",",".")}else{return"-"}}function convertDate(val,row){if(null==val||""==val){return""}var index=val.indexOf(".");if(index==-1){index=val.length}var str=val.substring(0,index).toString();str=str.replace(/-/g,"/");var date=new Date(str);var y=date.getFullYear();var m=date.getMonth()+1;var d=date.getDate();return y+'-'+(m<10?('0'+m):m)+'-'+(d<10?('0'+d):d)}function clearSelectRows(datagrid){$(datagrid).datagrid("clearSelections");$(datagrid).datagrid("clearChecked")}$(document).ready(function(){$('.easyui-datebox').datebox({width:100})});function operRepaymentList(url){var t=document.body.scrollTop;$('<div id="repaymentDiv"/>').dialog({href:url,width:750,height:380,top:t,modal:true,title:'还款计划表',buttons:[{text:'保存',iconCls:'icon-save',handler:function(){window.saveRepaymentPlan()}},{text:'取消 ',iconCls:'icon-no',handler:function(){$("#repaymentDiv").dialog("close")}}],onClose:function(){$(this).dialog('destroy')},onLoad:function(){}})}